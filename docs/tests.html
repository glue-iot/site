<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Инструменты тестирования</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/docs/assets/css/styles.445be30a.css" as="style"><link rel="preload" href="/docs/assets/js/app.445be30a.js" as="script"><link rel="preload" href="/docs/assets/js/20.de8c6c28.js" as="script"><link rel="prefetch" href="/docs/assets/css/1.styles.f4f36f7a.css"><link rel="prefetch" href="/docs/assets/css/2.styles.7748e2fe.css"><link rel="prefetch" href="/docs/assets/js/1.f4f36f7a.js"><link rel="prefetch" href="/docs/assets/js/10.f7323774.js"><link rel="prefetch" href="/docs/assets/js/11.29cc5038.js"><link rel="prefetch" href="/docs/assets/js/12.0144af31.js"><link rel="prefetch" href="/docs/assets/js/13.a4c8ce52.js"><link rel="prefetch" href="/docs/assets/js/14.2030686e.js"><link rel="prefetch" href="/docs/assets/js/15.384de1d9.js"><link rel="prefetch" href="/docs/assets/js/16.8eaf230c.js"><link rel="prefetch" href="/docs/assets/js/17.67e86a18.js"><link rel="prefetch" href="/docs/assets/js/18.d143aab4.js"><link rel="prefetch" href="/docs/assets/js/19.ae6df5c1.js"><link rel="prefetch" href="/docs/assets/js/2.7748e2fe.js"><link rel="prefetch" href="/docs/assets/js/21.31d6cc05.js"><link rel="prefetch" href="/docs/assets/js/3.0317d221.js"><link rel="prefetch" href="/docs/assets/js/4.62e49d38.js"><link rel="prefetch" href="/docs/assets/js/5.7c088b63.js"><link rel="prefetch" href="/docs/assets/js/6.64581d1a.js"><link rel="prefetch" href="/docs/assets/js/7.98c58839.js"><link rel="prefetch" href="/docs/assets/js/8.443b945f.js"><link rel="prefetch" href="/docs/assets/js/9.963e62d2.js">
    <link rel="stylesheet" href="/docs/assets/css/styles.445be30a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><img src="/docs/logo.png" alt="" class="logo"> <!----></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Основная информация</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/what_glue.html" class="nav-link">Что такое GLUE</a></li><li class="dropdown-item"><!----> <a href="/docs/start.html" class="nav-link">Запуск системы</a></li><li class="dropdown-item"><!----> <a href="/docs/panel.html" class="nav-link">Панель управления</a></li><li class="dropdown-item"><!----> <a href="/docs/scripts_and_drivers.html" class="nav-link">Скрипты и драйвера</a></li><li class="dropdown-item"><!----> <a href="/docs/logs.html" class="nav-link">Система логов</a></li><li class="dropdown-item"><!----> <a href="/docs/bus.html" class="nav-link">Общая шина</a></li><li class="dropdown-item"><!----> <a href="/docs/lua.html" class="nav-link">Язык Lua</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Документация</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/panel.html" class="nav-link">Панель управления</a></li><li class="dropdown-item"><!----> <a href="/docs/developers.html" class="nav-link">Руководство разработчика</a></li><li class="dropdown-item"><!----> <a href="/docs/inside.html" class="nav-link">Внутренности системы</a></li><li class="dropdown-item"><!----> <a href="/docs/tests.html" class="nav-link router-link-exact-active router-link-active">Инструменты тестирования</a></li><li class="dropdown-item"><!----> <a href="/docs/changelog.html" class="nav-link">История изменений</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Примеры</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/examples_driver.html" class="nav-link">Драйвера</a></li><li class="dropdown-item"><!----> <a href="/docs/examples_bus_event.html" class="nav-link">Bus-event скрипты</a></li><li class="dropdown-item"><!----> <a href="/docs/examples_web_event.html" class="nav-link">Web-event скрипты</a></li><li class="dropdown-item"><!----> <a href="/docs/examples_timer_event.html" class="nav-link">Timer-event скрипты</a></li><li class="dropdown-item"><!----> <a href="/docs/examples_shedule_event.html" class="nav-link">Shedule-event скрипты</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Основная информация</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/what_glue.html" class="nav-link">Что такое GLUE</a></li><li class="dropdown-item"><!----> <a href="/docs/start.html" class="nav-link">Запуск системы</a></li><li class="dropdown-item"><!----> <a href="/docs/panel.html" class="nav-link">Панель управления</a></li><li class="dropdown-item"><!----> <a href="/docs/scripts_and_drivers.html" class="nav-link">Скрипты и драйвера</a></li><li class="dropdown-item"><!----> <a href="/docs/logs.html" class="nav-link">Система логов</a></li><li class="dropdown-item"><!----> <a href="/docs/bus.html" class="nav-link">Общая шина</a></li><li class="dropdown-item"><!----> <a href="/docs/lua.html" class="nav-link">Язык Lua</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Документация</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/panel.html" class="nav-link">Панель управления</a></li><li class="dropdown-item"><!----> <a href="/docs/developers.html" class="nav-link">Руководство разработчика</a></li><li class="dropdown-item"><!----> <a href="/docs/inside.html" class="nav-link">Внутренности системы</a></li><li class="dropdown-item"><!----> <a href="/docs/tests.html" class="nav-link router-link-exact-active router-link-active">Инструменты тестирования</a></li><li class="dropdown-item"><!----> <a href="/docs/changelog.html" class="nav-link">История изменений</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Примеры</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/examples_driver.html" class="nav-link">Драйвера</a></li><li class="dropdown-item"><!----> <a href="/docs/examples_bus_event.html" class="nav-link">Bus-event скрипты</a></li><li class="dropdown-item"><!----> <a href="/docs/examples_web_event.html" class="nav-link">Web-event скрипты</a></li><li class="dropdown-item"><!----> <a href="/docs/examples_timer_event.html" class="nav-link">Timer-event скрипты</a></li><li class="dropdown-item"><!----> <a href="/docs/examples_shedule_event.html" class="nav-link">Shedule-event скрипты</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Инструменты тестирования</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/docs/tests.html#общая-информация" class="sidebar-link">Общая информация</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/tests.html#установка-и-настройка" class="sidebar-link">Установка и настройка</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/tests.html#запуск-тестов" class="sidebar-link">Запуск тестов</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/tests.html#тест-кейсы" class="sidebar-link">Тест - кейсы</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/tests.html#tarantool" class="sidebar-link">Tarantool</a></li><li class="sidebar-sub-header"><a href="/docs/tests.html#скрипты" class="sidebar-link">Скрипты</a></li><li class="sidebar-sub-header"><a href="/docs/tests.html#шина" class="sidebar-link">Шина</a></li><li class="sidebar-sub-header"><a href="/docs/tests.html#логи" class="sidebar-link">Логи</a></li><li class="sidebar-sub-header"><a href="/docs/tests.html#резервное-копирование" class="sidebar-link">Резервное копирование</a></li><li class="sidebar-sub-header"><a href="/docs/tests.html#встроенные-функции" class="sidebar-link">Встроенные функции</a></li></ul></li><li><a href="/docs/tests.html#прочая-информация" class="sidebar-link">Прочая информация</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="инструменты-тестирования"><a href="#инструменты-тестирования" aria-hidden="true" class="header-anchor">#</a> Инструменты тестирования</h1> <h2 id="общая-информация"><a href="#общая-информация" aria-hidden="true" class="header-anchor">#</a> Общая информация</h2> <p>Тестирование работоспособности модулей Glue, на данном этапе, сводится к тестированию API путем отправки на endpoint'ы HTTP запросов и анализу изменения состояния системы после них.</p> <h2 id="установка-и-настройка"><a href="#установка-и-настройка" aria-hidden="true" class="header-anchor">#</a> Установка и настройка</h2> <p>Для тестирования используется фреймворк <a href="https://olivinelabs.com/busted/" target="_blank" rel="noopener noreferrer">Busted<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Для запуска тестов, необходимо установить сам Busted и некоторые зависимости.</p> <p>Последовательность установки:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">apt-get</span> <span class="token function">install</span> luarocks <span class="token comment">#(или brew install luarocks на MacOS)</span>
luarocks <span class="token function">install</span> busted
luarocks <span class="token function">install</span> lbase64
luarocks <span class="token function">install</span> fun
luarocks <span class="token function">install</span> md5
luarocks <span class="token function">install</span> luajson
</code></pre></div><h2 id="запуск-тестов"><a href="#запуск-тестов" aria-hidden="true" class="header-anchor">#</a> Запуск тестов</h2> <p>Для запуска тестов, перейдите в папку ./tests в корневой директории Glue и выполните:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">bash</span> run_tests.sh
</code></pre></div><p>Этот скрипт создает папку для логов Tarantool'а (<code>./tests/logs/</code>), запускает тесты и удаляет тестовую базу данных (<code>./test_db</code>) после прохода всех тестов.</p> <p>Файл <code>run_tests.sh</code> можно отредактировать для того, чтобы запускались только тесты с определенным тегом.<br>
Для этого, в нем строку <code>busted tests.lua</code> нужно заменить на <code>busted -t &quot;имя_тега&quot; tests.lua</code>.</p> <p>Теги можно создавать в файле <code>./tests/.busted</code>.</p> <div class="language- extra-class"><pre class="language-text"><code>    ...
    tarantool = {
        tags = &quot;tarantool&quot;,
        verbose = true
    },
    backups = {
        tags = &quot;backups&quot;,
        verbose = true
    },
    functions = {
        tags = &quot;functions&quot;,
        verbose = true
    },
    параметр_запуска = {
        tags = &quot;название_тега&quot;,
        verbose = true 
    }
</code></pre></div><p>В результате запуска теста, в консоли вы увидите примерно такой вывод:</p> <div class="language- extra-class"><pre class="language-text"><code>bash run_tests.sh 
●●●●●●●●●●●●◼●●●●●●●●●●●●●●●●◼●●●
31 successes / 2 failures / 0 errors / 0 pending : 14.10226 seconds
</code></pre></div><p>Под ним будет вывод информации о провалившихся тестах.</p> <h2 id="тест-кейсы"><a href="#тест-кейсы" aria-hidden="true" class="header-anchor">#</a> Тест - кейсы</h2> <h3 id="tarantool"><a href="#tarantool" aria-hidden="true" class="header-anchor">#</a> Tarantool</h3> <p><em>Тег &quot;tarantool&quot;</em></p> <ul><li>Запуск Tarantool</li> <li>Выключение Tarantool</li></ul> <h3 id="скрипты"><a href="#скрипты" aria-hidden="true" class="header-anchor">#</a> Скрипты</h3> <p><em>Тег &quot;script&quot;</em></p> <ul><li>создание скрипта</li> <li>изменение имени(учитывая символы в именах, вроде +/_-%),</li> <li>изменение объекта</li> <li>изменение тела</li> <li>копирование скрипта</li> <li>получение информации о скрипте</li> <li>удаление запущенного скрипта</li> <li>удаление остановленного скрипта</li> <li>удаление скрипта, в котором destroy возвращает false</li> <li>cоздание невалидного скрипта, запуск, получение ошибки</li> <li>создание валидного скрипта, запуск, получение подтверждения запуска</li> <li>cоздание скрипта, изменяющего bus, запуск, проверка изменения bus</li> <li>cоздание скрипта, создающего записи в логах, запуск, проверка логов</li> <li>cоздание скрипта, подписанного на события, генерация события, проверка реакции скрипта</li></ul> <h3 id="шина"><a href="#шина" aria-hidden="true" class="header-anchor">#</a> Шина</h3> <p><em>Тег &quot;bus&quot;</em></p> <ul><li>создание записи</li> <li>изменение метаданных</li> <li>изменение значения</li> <li>удаление записи</li></ul> <h3 id="логи"><a href="#логи" aria-hidden="true" class="header-anchor">#</a> Логи</h3> <p><em>Тег &quot;logs&quot;</em></p> <ul><li>создание записей в логах разных уровней</li> <li>получение записей с сортировкой по level(проверка фильтрации)</li> <li>очистка логов</li></ul> <h3 id="резервное-копирование"><a href="#резервное-копирование" aria-hidden="true" class="header-anchor">#</a> Резервное копирование</h3> <p><em>Тег &quot;backups&quot;</em></p> <ul><li>наполнение данными базы</li> <li>проверка создания копии</li> <li>проверка восстановления копии</li> <li>проверка, что в копию попадают скрипты и bus</li> <li>проверка, что в копию не попадают логи</li></ul> <h3 id="встроенные-функции"><a href="#встроенные-функции" aria-hidden="true" class="header-anchor">#</a> Встроенные функции</h3> <p><em>Тег &quot;functions&quot;</em></p> <ul><li>создание скрипта с функциями <code>round()</code>, <code>deepcopy()</code>, проверка правильности работы этих функций</li> <li>создание записи в bus в случае успеха, проверка наличия записи.</li></ul> <h2 id="прочая-информация"><a href="#прочая-информация" aria-hidden="true" class="header-anchor">#</a> Прочая информация</h2> <p>Тестовые скрипты, которые используются для создания ситуаций для тестов располагаются в папке <code>./tests/test_scripts</code>.</p> <p>Логи Tarantool пишутся в папку <code>./tests/logs</code>. Название файла с логами содержит дату и случайную строку.</p> <p>Тестовый процесс Tarantool запускается на 8888 порту и работает с тестовой базой (<code>./test_db</code>).<br>
Функционированию рабочей версии Glue это никак не мешает.</p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">11/15/2018, 6:23:38 PM</span></div></div> <!----> </div> <!----> <noscript><div><img src="https://mc.yandex.ru/watch/52086813" alt style="position:absolute; left:-9999px;"></div></noscript></div></div>
    <script src="/docs/assets/js/app.445be30a.js" defer></script><script src="/docs/assets/js/20.de8c6c28.js" defer></script>
  </body>
</html>
